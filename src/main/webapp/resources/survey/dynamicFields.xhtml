<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:o="http://myfaces.apache.org/orchestra"
	xmlns:composite="http://java.sun.com/jsf/composite"
	xmlns:c="http://java.sun.com/jsp/jstl/core">

<composite:interface>
	<composite:attribute name="block" required="true"
		type="py.una.med.base.survey.components.DynamicSurveyFields" />

	<composite:attribute name="idBlock" required="true" />
	<composite:attribute name="controller" required="true"
		type="py.una.med.base.survey.controller.ISIGHDynamicSurveyBaseController" />
	<composite:attribute name="withActions" default="true"
		shortDescription="Show a column with edit and delete"
		type="java.lang.Boolean" />
	<composite:attribute name="height" default="100px" />
	<composite:attribute name="width" default="620px" />
</composite:interface>
<composite:implementation>
	<rich:panel header="#{cc.attrs.block.title}" id="#{cc.attrs.idBlock}">
		<h:panelGrid columns="3"
			columnClasses="form_label, form_input, form_error">
			<c:set value="#{0}" var="cont" />
			<c:forEach items="#{cc.attrs.block.fields}" var="element">

				<c:if test="#{cc.attrs.block.getTypeField(cont) eq 'TEXTO'}">
					<h:outputLabel value="#{cc.attrs.block.labels[cont]}" />
					<h:inputText value="#{element.field.value}"
						id="#{cc.attrs.block.id}_#{cont}"
						disabled="#{not cc.attrs.controller.isEditable()}" />
				</c:if>
				<c:if test="#{cc.attrs.block.getTypeField(cont) eq 'RADIO'}">
					<h:outputLabel value="#{cc.attrs.block.labels[cont]}" />
					<h:panelGrid
						columns="#{cc.attrs.block.getAnswerOptions(cont).size()*3}"
						id="#{cc.attrs.block.id}_#{cont}_pgrid">
						<h:selectOneRadio value="#{element.oneOption}"
							converter="#{cc.attrs.block.converter}"
							required="#{cc.attrs.block.isRequiredField(cont)}"
							requiredMessage="#{msg['REQUIRED_VIEW']}"
							style="text-transform:none !important;"
							id="#{cc.attrs.block.id}_#{cont}"
							disabled="#{not cc.attrs.controller.isEditable()}">
							<f:selectItems value="#{cc.attrs.block.getAnswerOptions(cont)}" />
							<a4j:ajax event="change"
								render="#{cc.attrs.block.id}_#{cont}_pgrid"
								listener="#{cc.attrs.block.enableCheckText()}" />
							<a4j:param name="index" value="#{cont}" />
						</h:selectOneRadio>
						<h:inputText value="#{element.field.value}"
							id="#{cc.attrs.block.id}_#{cont}_input"
							rendered="#{element.visibilityCheckText}">
							<a4j:ajax event="blur"
								listener="#{cc.attrs.block.completeChangeListener}" />
							<a4j:param name="index" value="#{cont}" />
						</h:inputText>
					</h:panelGrid>
				</c:if>
				<c:if test="#{cc.attrs.block.getTypeField(cont) eq 'CHECK'}">
					<h:outputLabel value="#{cc.attrs.block.labels[cont]}" />
					<h:panelGrid
						columns="#{cc.attrs.block.getAnswerOptions(cont).size()*3}"
						id="#{cc.attrs.block.id}_#{cont}_pgrid">
						<h:selectManyCheckbox value="#{element.manyOptions}"
							converter="#{cc.attrs.block.converter}"
							required="#{cc.attrs.block.isRequiredField(cont)}"
							requiredMessage="#{msg['REQUIRED_VIEW']}"
							style="text-transform:none !important;"
							id="#{cc.attrs.block.id}_#{cont}"
							disabled="#{not cc.attrs.controller.isEditable()}">
							<f:selectItems value="#{cc.attrs.block.getAnswerOptions(cont)}" />
							<a4j:ajax event="change"
								render="#{cc.attrs.block.id}_#{cont}_pgrid"
								listener="#{cc.attrs.block.enableCheckText()}" />
							<a4j:param name="index" value="#{cont}" />
						</h:selectManyCheckbox>
						<h:inputText value="#{element.field.value}"
							id="#{cc.attrs.block.id}_#{cont}_input"
							rendered="#{element.visibilityCheckText}">
							<a4j:ajax event="blur"
								listener="#{cc.attrs.block.completeChangeListener}" />
							<a4j:param name="index" value="#{cont}" />
						</h:inputText>
					</h:panelGrid>
				</c:if>
				<c:if test="#{cc.attrs.block.getTypeField(cont) eq 'COMBO'}">
					<h:outputLabel value="#{cc.attrs.block.labels[cont]}" />
					<h:selectOneMenu value="#{element.oneOption}"
						id="#{cc.attrs.block.id}_#{cont}"
						converter="#{cc.attrs.block.converter}"
						required="#{cc.attrs.block.isRequiredField(cont)}"
						requiredMessage="#{msg['REQUIRED_VIEW']}"
						disabled="#{not cc.attrs.controller.isEditable()}">
						<f:selectItem itemLabel="#{msg['ABM_SURVEY_SELECT']}"
							noSelectionOption="true" />
						<f:selectItems value="#{cc.attrs.block.getAnswerOptions(cont)}" />
					</h:selectOneMenu>
				</c:if>
				<c:if test="#{cc.attrs.block.getTypeField(cont) eq 'TEXTO_FECHA'}">
					<h:outputLabel value="#{cc.attrs.block.labels[cont]}"
						required="#{cc.attrs.block.isRequiredField(cont)}"
						requiredMessage="#{msg['REQUIRED_VIEW']}" />
					<rich:calendar value="#{element.field.value}"
						id="#{cc.attrs.block.id}_#{cont}"
						converter="#{cc.attrs.block.converterString}"
						datePattern="dd/MM/yyyy"
						disabled="#{not cc.attrs.controller.isEditable()}">
					</rich:calendar>
				</c:if>
				<c:if test="#{cc.attrs.block.getTypeField(cont) eq 'TEXTO_AREA'}">
					<h:outputLabel value="#{cc.attrs.block.labels[cont]}" />
					<h:inputTextarea value="#{element.field.value}"
						id="#{cc.attrs.block.id}_#{cont}"
						style="width:182px; height: 115px; text-transform: uppercase;"
						disabled="#{not cc.attrs.controller.isEditable()}" />
				</c:if>
				<rich:messages ajaxRendered="true"
					for="#{cc.attrs.block.id}_#{cont}" />
				<c:set value="#{cont + 1}" var="cont" />
			</c:forEach>
		</h:panelGrid>

	</rich:panel>

</composite:implementation>
</html>